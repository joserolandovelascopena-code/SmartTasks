<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Verificando cuenta...</title>
  </head>
  <body>
    <h2>Verificando tu cuenta...</h2>

    <script type="module">
      import { supabaseClient } from "../../assets/js/supabase.js";

      const hash = window.location.hash;
      const params = new URLSearchParams(hash.substring(1));

      const access_token = params.get("access_token");
      const refresh_token = params.get("refresh_token");

      if (!access_token || !refresh_token) {
        document.body.innerHTML = "<h3>Enlace inválido o expirado</h3>";
        throw new Error("No token");
      }

      await supabaseClient.auth.setSession({
        access_token,
        refresh_token,
      });

      // ✅ Cuenta confirmada → entrar a la app o login
      window.location.href = "../../index.html";
    </script>
  </body>
</html>
